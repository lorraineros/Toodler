{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport * as FileSystem from 'expo-file-system';\nvar imageDirectory = `${FileSystem.documentDirectory}images`;\nvar onException = function onException(cb, errorHandler) {\n  try {\n    return cb();\n  } catch (err) {\n    if (errorHandler) {\n      return errorHandler(err);\n    }\n    console.error(err);\n  }\n};\nexport var cleanDirectory = function () {\n  var _ref = _asyncToGenerator(function* () {\n    yield FileSystem.deleteAsync(imageDirectory);\n  });\n  return function cleanDirectory() {\n    return _ref.apply(this, arguments);\n  };\n}();\nexport var copyFile = function () {\n  var _ref2 = _asyncToGenerator(function* (file, newLocation) {\n    return yield onException(function () {\n      return FileSystem.copyAsync({\n        from: file,\n        to: newLocation\n      });\n    });\n  });\n  return function copyFile(_x, _x2) {\n    return _ref2.apply(this, arguments);\n  };\n}();\nexport var addImage = function () {\n  var _ref3 = _asyncToGenerator(function* (imageLocation) {\n    var folderSplit = imageLocation.split('/');\n    var fileName = folderSplit[folderSplit.length - 1];\n    yield onException(function () {\n      return copyFile(imageLocation, `${imageDirectory}/${fileName}`);\n    });\n    return {\n      name: fileName,\n      type: 'image',\n      file: yield loadImage(fileName)\n    };\n  });\n  return function addImage(_x3) {\n    return _ref3.apply(this, arguments);\n  };\n}();\nexport var remove = function () {\n  var _ref4 = _asyncToGenerator(function* (name) {\n    return yield onException(function () {\n      return FileSystem.deleteAsync(`${imageDirectory}/${name}`, {\n        idempotent: true\n      });\n    });\n  });\n  return function remove(_x4) {\n    return _ref4.apply(this, arguments);\n  };\n}();\nexport var loadImage = function () {\n  var _ref5 = _asyncToGenerator(function* (fileName) {\n    return yield onException(function () {\n      return FileSystem.readAsStringAsync(`${imageDirectory}/${fileName}`, {\n        encoding: FileSystem.EncodingType.Base64\n      });\n    });\n  });\n  return function loadImage(_x5) {\n    return _ref5.apply(this, arguments);\n  };\n}();\nvar setupDirectory = function () {\n  var _ref6 = _asyncToGenerator(function* () {\n    var dir = yield FileSystem.getInfoAsync(imageDirectory);\n    if (!dir.exists) {\n      yield FileSystem.makeDirectoryAsync(imageDirectory);\n    }\n  });\n  return function setupDirectory() {\n    return _ref6.apply(this, arguments);\n  };\n}();\nexport var getAllImages = function () {\n  var _ref7 = _asyncToGenerator(function* () {\n    yield setupDirectory();\n    var result = yield onException(function () {\n      return FileSystem.readDirectoryAsync(imageDirectory);\n    });\n    return Promise.all(result.map(function () {\n      var _ref8 = _asyncToGenerator(function* (fileName) {\n        return {\n          name: fileName,\n          type: 'image',\n          file: yield loadImage(fileName)\n        };\n      });\n      return function (_x6) {\n        return _ref8.apply(this, arguments);\n      };\n    }()));\n  });\n  return function getAllImages() {\n    return _ref7.apply(this, arguments);\n  };\n}();","map":{"version":3,"names":["FileSystem","imageDirectory","documentDirectory","onException","cb","errorHandler","err","console","error","cleanDirectory","_ref","_asyncToGenerator","deleteAsync","apply","arguments","copyFile","_ref2","file","newLocation","copyAsync","from","to","_x","_x2","addImage","_ref3","imageLocation","folderSplit","split","fileName","length","name","type","loadImage","_x3","remove","_ref4","idempotent","_x4","_ref5","readAsStringAsync","encoding","EncodingType","Base64","_x5","setupDirectory","_ref6","dir","getInfoAsync","exists","makeDirectoryAsync","getAllImages","_ref7","result","readDirectoryAsync","Promise","all","map","_ref8","_x6"],"sources":["C:/Users/annar/OneDrive/HR/2023-2/3ja vikna/Toodler/src/services/fileService.js"],"sourcesContent":["import * as FileSystem from 'expo-file-system'\r\nconst imageDirectory = `${FileSystem.documentDirectory}images`\r\n\r\nconst onException = (cb, errorHandler) => {\r\n  try {\r\n    return cb()\r\n  } catch (err) {\r\n    if (errorHandler) {\r\n      return errorHandler(err)\r\n    }\r\n    console.error(err)\r\n  }\r\n}\r\n\r\nexport const cleanDirectory = async () => {\r\n  await FileSystem.deleteAsync(imageDirectory)\r\n}\r\n\r\nexport const copyFile = async (file, newLocation) => {\r\n  return await onException(() => FileSystem.copyAsync({\r\n    from: file,\r\n    to: newLocation\r\n  }))\r\n}\r\n\r\nexport const addImage = async imageLocation => {\r\n  const folderSplit = imageLocation.split('/')\r\n  const fileName = folderSplit[folderSplit.length - 1]\r\n  await onException(() => copyFile(imageLocation, `${imageDirectory}/${fileName}`))\r\n\r\n  return {\r\n    name: fileName,\r\n    type: 'image',\r\n    file: await loadImage(fileName)\r\n  }\r\n}\r\n\r\nexport const remove = async name => {\r\n  return await onException(() => FileSystem.deleteAsync(`${imageDirectory}/${name}`, { idempotent: true }))\r\n}\r\n\r\nexport const loadImage = async fileName => {\r\n  return await onException(() => FileSystem.readAsStringAsync(`${imageDirectory}/${fileName}`, {\r\n    encoding: FileSystem.EncodingType.Base64\r\n  }))\r\n}\r\n\r\nconst setupDirectory = async () => {\r\n  const dir = await FileSystem.getInfoAsync(imageDirectory)\r\n  if (!dir.exists) {\r\n    await FileSystem.makeDirectoryAsync(imageDirectory)\r\n  }\r\n}\r\n\r\nexport const getAllImages = async () => {\r\n  // Check if directory exists\r\n  await setupDirectory()\r\n\r\n  const result = await onException(() => FileSystem.readDirectoryAsync(imageDirectory))\r\n  return Promise.all(result.map(async fileName => {\r\n    return {\r\n      name: fileName,\r\n      type: 'image',\r\n      file: await loadImage(fileName)\r\n    }\r\n  }))\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}